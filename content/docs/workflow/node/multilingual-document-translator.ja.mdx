---
title: "反復処理：すべてのタスクを同時に実行"
description: Difyを使用した多言語ドキュメント翻訳ツールの構築
---

⬇️ 読む前に、試してみてください

<iframe
 src="https://instance.hellodify.com/workflow/fmyDgq6yIS76TYZD"
 style={{
   width: '100%',
   minHeight: '400px'
 }}
 frameBorder="0"
 allow="microphone">
</iframe>

---

# はじめに
急速に進化するAIアプリケーション開発の分野では、ローコードプラットフォームが企業のインテリジェントソリューション実装方法を革命的に変えています。Difyは変革的なオープンソースプラットフォームとして登場し、最小限のコーディング努力でAI駆動のワークフローを構築、展開、スケーリングすることをチームに可能にします。そのモジュラーアーキテクチャと視覚的なワークフローデザインにより、ドキュメント処理から多言語コラボレーションまで、インフラストラクチャの複雑さを抽象化しながらAI機能のシームレスな統合を実現します。

この記事では、DeepSeek R1とオープンソースのローコード開発プラットフォームDifyを組み合わせて、企業レベルの多言語ドキュメント翻訳ツールを迅速に構築する方法を示します。Difyのシームレスな統合により、ユーザーは複雑なプログラミングなしでドキュメントの解析、スタイリスティックな翻訳、バッチ処理を自動化でき、言語間コラボレーションの効率を大幅に向上させます。技術マニュアルの正確な翻訳であれ、多言語マーケティングコンテンツの柔軟な適応であれ、このソリューションはモジュラーワークフローを通じて簡単に実装でき、グローバルチームにコスト効率が高く、高度に制御可能なAIソリューションを提供します。

# Backend as a Service：Difyローコードを使用したAIアプリケーションバックエンドの構築

## 前提条件
1. DeepSeek APIキーを申請する。

2. Difyアカウントに登録する。

### DeepSeek APIキーの申請
方法1：DeepSeek APIオープンプラットフォーム経由

[DeepSeek APIオープンプラットフォーム](https://platform.deepseek.com/)にアクセスし、画面上の指示に従ってAPIキーを申請します。

### Difyへの登録
Difyは生成AIアプリケーションを迅速に構築するのに役立つプラットフォームです。DeepSeek APIと統合することで、使いやすいDeepSeek AIアプリケーションを迅速に作成できます。

#### DeepSeekをDifyに接続する
Difyプラットフォームにアクセスし、右上のアバターをクリック → 設定 → モデルプロバイダーを選択し、DeepSeekを見つけて、先ほど取得したAPIキーを貼り付けます。

![image.png](https://s2.loli.net/2025/05/13/hDtK2TxFXIPOpzu.png)

保存をクリックします。検証が成功すると、成功メッセージが表示されます。

#### アプリケーションの作成
**Studio**に入り、**ブランク → ワークフロー**から作成をクリックします。

> **チャットフローとワークフローとは？**
> Difyの高度なアプリケーションタイプには、チャットフローとワークフローがあります。チャットフローはよりチャットボットのように動作します。つまり、ユーザーとループで対話できるロボットです。一方、ワークフローはよりスクリプトのように動作し、呼び出されるときに一度だけ実行され、通常はアプリケーションバックエンドとして使用されます。
> 構築しているアプリケーションシナリオに応じて、適切なアプリケーションタイプを選択する必要があります。このデモでは、ワークフロータイプを選択します。

![image.png](https://s2.loli.net/2025/05/13/OkqsFUW4Q3LCzb1.png)

## ワークフローの構築
アプリケーションに入ると、ノードを追加して接続することでワークフローを編集できます。コードを処理する必要はありません。

以下では、ドキュメント翻訳ツールの作成方法を示します：

### スタートノード
スタートノードで、`+`をクリックしてファイルタイプの変数を追加します。ファイルタイプをファイルリストとして選択し、ファイルタイプをドキュメントに設定し、変数名を「file」とします。

![image.png](https://s2.loli.net/2025/05/13/1BCq9ijeUFDJoOl.png)

また、翻訳スタイルを制限する必要があります。例：フォーマル、プロフェッショナル、カジュアル、熱意のある、ユーモラス。`+`をクリックしてオプションタイプの変数を追加し、各オプションの内容を入力し、変数名を`style`に設定します。

![image.png](https://s2.loli.net/2025/05/13/lR17g6h4rnz9Aas.png)

### 反復処理
スタートノードでは、ファイルのリストを設定しました。ワークフローノードを繰り返し構築することを避けるために、Difyは反復ノードを導入しています。反復ノードでは、ワークフローはリストタイプの変数をすべて完全に実行し、個別に出力します。

反復の詳細な説明については、[ドキュメンテーション -> 反復](https://docs.dify.ai/guides/workflow/node/iteration)を参照してください。

![image.png](https://s2.loli.net/2025/05/13/PGnh629VLObweQ8.png)


以下では、反復ノード内のワークフローをさらに設定します：

まず、スタートノードの後に反復ノードを追加します。反復ノードは小さなワークフローのようなもので、スタート変数と出力変数もあることがわかります。ここでは、反復ノードの入力変数を`file`に設定する必要があります。

![image.png](https://s2.loli.net/2025/05/13/1EVQUTfvPuNBCtb.png)


次に、反復ノード内にノードを追加します。LLMはアップロードされたドキュメントの内容を直接読み取ることができないため、ドキュメント抽出器を追加して、ドキュメントコンテンツをLLMが読み取れるテキストに変換する必要があります。ドキュメント抽出器の入力変数は、スタートノードのファイルファイルです。

ドキュメント抽出器の後に、LLMノードを追加し、システムプロンプトとユーザー入力を設定します。

以下はシステムプロンプトです：

```xml
<Role>
あなたは中国語と英語の翻訳専門家で、ユーザーの入力を中国語から英語へ、または英語から中国語へ翻訳します。
</Role>
<Task>
必要な翻訳スタイルに従う必要があります。
非中国語コンテンツの場合、中国語の翻訳結果を提供します。ユーザーは翻訳のためのコンテンツをアシスタントに送信でき、アシスタントは中国語の言語習慣に準拠した対応する翻訳結果で回答します。トーンやスタイルを調整し、特定の単語の文化的意味や地域差を考慮することができます。
翻訳者として、翻訳は忠実さ、表現力、優雅さの基準に従うべきです。「忠実さ」は原文の内容と意図に忠実であることを意味し、「表現力」は翻訳がスムーズで理解しやすく、表現が明確であることを意味し、「優雅さ」は翻訳における言語の文化的美学と美しさを追求します。目標は、原文の精神に忠実でありながら、目標言語文化と読者の美学的鑑賞に合致する翻訳を作成することです。
翻訳スタイル：{{style}}
</Task>
<Limitation>
関係のないナンセンスを出力しないでください。
</Limitation>
```

システムプロンプトでは、`/`または`{`を入力して変数を挿入できます。

公式DeepSeekは、すべてのユーザーが参照できる[プロンプトライブラリ](https://api-docs.deepseek.com/prompt-library)を提供しています。

最初からLLMアプリケーションを構築する場合、Difyはより包括的で使いやすいテンプレートも提供しています。[エクスプローラページ](https://cloud.dify.ai/explore/apps)を開き、必要なテンプレートを閲覧してスタジオに取り込み、編集することができます。

![image.png](https://s2.loli.net/2025/05/13/24OE8MUklQ3CHKZ.png)

最後に、反復ノードをクリックし、出力変数をLLMの出力に設定します。

![image.png](https://s2.loli.net/2025/05/13/Xv4qfCtujdzr15g.png)


## テストと公開
公開する前に、サービスが適切に機能していることを確認するためにテストを実行できます。

**「実行」**をクリックし、すべての変数を入力し、**「実行開始」**をクリックして実行を開始します。

![image.png](https://s2.loli.net/2025/05/13/CuSRDVpAQLMZBYs.png)
![image.png](https://s2.loli.net/2025/05/13/4LFlRPZgrDwV73U.png)


テストが合格したら、**「公開」**をクリックしてアプリケーションをオンラインデプロイします。デプロイリンクを友人と共有して一緒にテストすることができます。

![image.png](https://s2.loli.net/2025/05/13/fBQYcbX86i3uVOU.png)

アプリケーションのフロントエンドインターフェースをさらに開発したい場合は、DifyのAPIドキュメントを参照できます。右側の**「APIアクセス」**をクリックして、APIドキュメントを表示し、アプリケーションのAPIキーを管理します。

![image.png](https://s2.loli.net/2025/05/13/Of7D5MLNQFnXUpe.png)

## パフォーマンスの最適化
テストでは、特にDeepSeek R1のような推論モデルを使用する場合、ドキュメントの翻訳速度が遅いことがわかるかもしれません。速度を最大化するために、ワークフロー内の反復を改善する必要があります。

反復ノードを選択し、並列モードをオンにして、合理的な並列タスク数を設定します。

![image.png](https://s2.loli.net/2025/05/13/en53gXl1mREt6wB.png)

並列モードを有効にすると、ワークフローはすべてのタスクを順次ではなく同時に実行します。これにより効率が大幅に向上します。

![image.png](https://s2.loli.net/2025/05/13/iEPgUbmuS9WGMod.png)

## テンプレートの取得
自分でワークフローを構築するのが難しい場合は、エクスプローラページのDeepSeek列から直接テンプレートを取得するか、以下のリンクをコピーして、空白アプリケーションを作成するときに**「DSLからインポート」**を選択してURLを入力することができます。


<Cards>
  <Card 
    icon={<i className="ri-flow-chart" />} 
    href="https://discord.gg/drd3HnTv" 
    title="ワークフローを入手する"
  >
  <p>DSLファイルを入手するには、FirstLabに参加してください</p>
    <img src="https://s2.loli.net/2025/05/15/EcHqJQVslgP3N2v.png" alt="Twitterレシート" />
  </Card>
</Cards>